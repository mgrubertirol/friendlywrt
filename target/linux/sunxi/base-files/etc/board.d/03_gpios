#!/bin/sh /etc/rc.common
#

DIR=/sys/class/gpio

logger "Lora gpio init: Start"
# Powerup LoRa Modem work for ZHW
if [ ! -d "${DIR}/gpio2" ]; then
	echo 2 > ${DIR}/export
fi
echo out > ${DIR}/gpio2/direction
echo 1 > ${DIR}/gpio2/value
logger "Lora gpio init: End"

logger "Modem gpio init: Start"
# Make sure to set the LTE_PERSTn to high
if [ ! -d ${DIR}/gpio412/ ]; then
	echo 412 > ${DIR}/export || true
fi
echo out > ${DIR}/gpio412/direction
echo 1 > ${DIR}/gpio412/value

# Disable flight mode (LTE_WDISABLEn)
if [ ! -d ${DIR}/gpio413/ ]; then
	echo 413 > ${DIR}/export || true
fi
echo out > ${DIR}/gpio413/direction
echo 1 > ${DIR}/gpio413/value

if [ ! -d ${DIR}/gpio3/ ]; then
	echo 3 > ${DIR}/export | true
fi

echo out > ${DIR}/gpio3/direction

echo 0 > ${DIR}/gpio3/value
sleep 1
echo 1 > ${DIR}/gpio3/value
logger "Modem gpio init: End"

